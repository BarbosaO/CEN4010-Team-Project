<!-- views/pages/bookDetails.ejs -->
<!DOCTYPE html>
<html lang="en">
    <head>
        <% include partials/header.ejs %>
        <script type="text/javascript" src="../scripts/stars.js"></script>
        <script type="text/javascript" src="../scripts/validateReview.js"></script>
    </head>
    <body class="container-fluid">
        <main>
            <h1>Book Details</h1>
            <p>Book: 5db33704440f5c45987cfe48</p>

            <h1>reviews list</h1>
            <hr>
            <% reviews.forEach(review => {%>
                <p class="rating">Rating: <%= review.Rating %></p>
                <p class="date">Date: <%= review.Date %></p>
                <p class="comment">Comment: <%= review.Comment %> </p>
                <p class="anon">Anonymous: <%= review.Anonymous %></p>
                <hr>
            <% })%>

            <div class="container">
                <div class="row">
                    <div class="col-3"></div>
                    <div class="col-6">
                        <form action="/submitReview" method="POST">
                            <div class="form-group">
                                <div class="form-inline row">
                                    <div class="col-5"></div>
                                    <div class="col-7">
                                        <p id="invisibleNickname"style="display:none"><%= email %></p>
                                        <p id="nickname"style="margin-bottom:0; text-align:right;">Comment as: <%= email %></p>
                                    </div>
                                </div>
                                <textarea class="form-control" id="comment" name="comment" rows="3"></textarea>
                            </div>

                            <!-- input will hold value for date -->
                            <input type="text" class="d-none" id="date" name="date">

                            <!-- this input will hold the value for rating to send to backend -->
                            <input type="number" class="d-none" id="rating" name="rating">

                            <!-- Star Rating -->
                            <div class="form-inline row">
                                <div class="col-3">
                                    <span class="fa fa-star" id="star1"></span>
                                    <span class="fa fa-star" id="star2"></span>
                                    <span class="fa fa-star" id="star3"></span>
                                    <span class="fa fa-star" id="star4"></span>
                                    <span class="fa fa-star" id="star5"></span>
                                </div>
                                <div class="col-6"></div>
                                <div class="form-check col-3">
                                    <input class="form-check-input" type="checkbox" id="anonymous" name="anonymous" onclick="toggleAnon()">
                                    <label class="form-check-label" style="color:grey;" for="anonymous">Anonymous</label>
                                </div> 
                            </div>

                            <div class="row">
                                <div class="col-9"></div>
                                <div class="col-3">
                                    <button  onclick="validateReview()" class="btn btn-success btn-md" type="submit">Submit</button>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="col-3"></div>
                </div>    
        </main>

        <footer class="footer">
            <% include partials/footer.ejs %>
        </footer>

        <script>
                function toggleAnon(){
                    if(document.getElementById('anonymous').checked == true){
                        console.log('anon')
                        document.getElementById('nickname').innerHTML = 'Comment as: Anonymous';
                    }else{
                        document.getElementById('nickname').innerHTML = 'Comment as: ' + document.getElementById('invisibleNickname').innerHTML;
                    }
                }
            </script>
    </body>
</html>