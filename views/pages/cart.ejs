<!DOCTYPE html>
<html>
    <head>
    <% include partials/header.ejs %>
    </head>

    <body class="container-fluid">
            <h2 align="center"> <%= user[0].First_Name %>  Shopping Cart</h2>
            <main>
                <div class="container-fluid">
                    <!-- Beginning of the cart -->
                    <div class="row">
                        <div class="col-xs-10 col-md-7">        
                            <div class="jumbotron">  
                                <div class="cart"> 
                                    <% cart.forEach(cart => {%>  
                                    <div class="container">
                                        <div class="panel panel-default">
                                            <!-- Book title -->
                                            <div class="panel-body">
                                                <h5 class="title" align="center">Title: <%= cart.Title %> </h5>
                                            </div>
                                            <!-- Book price -->
                                            <div class="panel-body">
                                                <p class="price" >Price: $<%= cart.Price %></p>
                                            </div>
                                            <!-- Book qty-->
                                            <div class="panel-body">
                                                <p class="price" name ="qty" value ="<%= cart.qty %>">Qty: <%= cart.qty %></p>
                                            </div>
                                             <!-- Book cover -->
                                            <div class="panel-body">
                                                <table style width="100%">
                                                    <tr>
                                                        <th>
                                                            <div class="panel panel-default">
                                                                <div class="panel-body">
                                                                    <img src = <%= cart.Cover %> width="80" height="100" title="" </img>
                                                                </div>
                                                            </div>
                                                        </th>
                                                        <th>
                                                            <div class="panel panel-default">
                                                                <div class="panel-body">
                                                                    <p class="" align="center">Description:</p>
                                                                </div>
                                                                <div class="panel-body">
                                                                    <a align="center"><%= cart.Description %></a>
                                                                </div>
                                                            </div>
                                                        </th>
                                                    </tr>
                                                </table>
                                            </div>
                                            <!-- Delete from cart -->
                                            <div class="panel-body">
                                                <form action="/deleteCart?_method=DELETE" method="POST">
                                                    <input type="text" name="id" value="<%= cart._id %>" style="display:none;">
                                                    <button class="button2 button5" type="submit">Delete</button>
                                                </form>
                                            </div>
                                            <!-- table quantity adjustment -->
                                            <table style width="100%">
                                                <tr>
                                                    <th>
                                                        <div style=display:inline-block horizontal-align:right> 
                                                            <form action="/add1?_method=UPDATEONE" method="POST">
                                                                <input type="text" name="id" value="<%= cart._id %>" style="display:none;">
                                                                <input type="text" name = "qty" value = "<%= cart.qty %>" style="display:none;">
                                                                <button class="button1 button4" type="submit">+</button>
                                                            </form>
                                                        </div> 
                                                        <div style=display:inline-block horizontal-align:right> 
                                                            <form action="/minus1?_method=UPDATEONE" method="POST">
                                                                <input type="text" name="id" value="<%= cart._id %>" style="display:none;">
                                                                <input type="text" name ="qty" value = "<%= cart.qty %>" style="display:none;">
                                                                <button class="button1 button4" type="submit">-</button>
                                                            </form>
                                                        </div> 
                                                    </th> 
                                                </tr>
                                            </table> 
                                        </div>
                                    </div>
                                    <hr> </hr>
                                    <% })%>
                                </div> 
                            </div>
                            <!-- End of Cart -->
                        </div>
    
                        <!-- Begining of Payment Section -->
                
                        <div class="row"> 
                            <div class="container">
                                <h2>Order Summary</h2>
                                <table>  
                                    <tr>
                                        <th width="60%">
                                            <div class="container">
                                                <div class="panel panel-default">
                                                    <div class="panel-body">Subtotal</div>
                                                    <div class="panel-body">Tax</div>
                                                    <div class="panel-heading">Total</div>
                                                </div>
                                            </div>                
                                        </th>   
                                        <th>
                                            <div class="container">
                                                 
                                                <div class="panel panel-default">
                                                    <% total.forEach(total => {%>
                                                    <div class="panel-body" >$<%= (total.Subtotal).toFixed(2)%></div>
                                                    <div class="panel-body" >$<%= (total.Subtotal * 0.07).toFixed(2) %></div>
                                                    <div class="panel-heading" >$<%= (total.Subtotal + (total.Subtotal * 0.07)).toFixed(2) %></div>
                                                    <% })%>
                                                </div>                
                                            </div>
                                        </th> 
                                    </tr> 
                                </table>  
                            </div>
                        </div>
                    </div>
                </div> 
                                                 
            </main>
            <% include partials/footer.ejs %>
        </body>
    </html>